---
layout: post
title: Json2Template 介绍
---
<p><span style="font-family: 宋体;">Json2Template.js是一个Jquery插件, 用来绑定JavaScript对象到Html 模板中</span></p>
<div class="cnblogs_code">
<pre>$("#div").bindTemplate({<br />    source : json object,                                      <br />    template : <span style="color: #0000ff;">null</span> | $("#template") | "&lt;div&gt;{{object}}&lt;/div&gt;",<br />    dateFormat : "d.m.y",<br />    tagOpen : "{{",<br />    tagClose : "}}"<br />});</pre>
</div>
<p align="left"><em>bindTemplate(data)</em>&nbsp;&nbsp;:<span style="font-family: 宋体; font-size: 14px;">&nbsp;绑定数据对象到模板的操作方法</span></p>
<p align="left"><em>source</em> : <span style="font-family: 宋体; font-size: 14px;">json 格式的数据源</span></p>
<p align="left"><em>template</em> :</p>
<ol>
<li><span style="font-family: 宋体; font-size: 14px;">null 不提供模板,InnerHtml输出</span></li>
<li><span style="font-family: 宋体; font-size: 14px;">$(&ldquo;#template&rdquo;) 利用页面上定义好的html结构作为模板</span></li>
<li><span style="font-family: 宋体; font-size: 14px;">&ldquo;&lt;div&gt;{{...}}&lt;/div&gt;&rdquo; 直接定义模板</span></li>
</ol>
<p align="left"><em>dateFormat</em> : <span style="font-family: 宋体; font-size: 14px;">时间的格式化方式</span></p>
<p align="left"><em>tagOpen</em> : <span style="font-family: 宋体; font-size: 14px;">开始的标记标签</span></p>
<p align="left"><em>tagClose</em> : <span style="font-family: 宋体; font-size: 14px;">结束的标记标签</span></p>
<p align="left"><span style="font-family: 宋体; font-size: 14px;">其中</span><em>dateFormat, tagOpen, tagClose</em><span style="font-family: 宋体; font-size: 14px;">都可以为null采用默认的配置, </span><span style="font-family: 宋体;">有必要说一下默认的</span><em>tagOpen &amp; tagClose</em><span style="font-family: 宋体;">是用</span>&rdquo;{{&rdquo; 和 &rdquo;}}&rdquo;<span style="font-family: 宋体;">标记的</span></p>
<h3 align="left">Json2Template 的应用</h3>
<p align="left"><span style="font-family: 宋体; font-size: 14px;">下面我们通过一下小例子来看看Json2Template的简单用法</span></p>
<p align="left"><span style="font-family: 宋体; font-size: 14px;">创建一个MVC3的空项目</span></p>
<p align="left"><span style="font-family: 宋体; font-size: 14px;">首先我们需要一个对象来存储传递的数据</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> UserInfo<br />{<br />    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span>    ID      { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }<br />    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name    { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }<br />    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span>    Age     { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }<br />    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Address { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }<br />}</pre>
</div>
<p align="left"><span style="font-family: 宋体;">虚拟一个数据集合, 因为实际的应用场景中是通过查询数据库得到的</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">private</span> IList&lt;UserInfo&gt; InitUserInfo()<br />{<br />    IList&lt;UserInfo&gt; users = <span style="color: #0000ff;">new</span> List&lt;UserInfo&gt;();<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">1</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Chenkun</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Suzhou</span><span style="color: #800000;">"</span> });<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">2</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Zhangsan</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Beijing</span><span style="color: #800000;">"</span> });<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">3</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Lisi</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Henan</span><span style="color: #800000;">"</span> });<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">4</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Wangwu</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Shanghai</span><span style="color: #800000;">"</span> });<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">5</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Zhaoliu</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Guangzhou</span><span style="color: #800000;">"</span> });<br />    users.Add(<span style="color: #0000ff;">new</span> UserInfo() { ID = <span style="color: #800080;">6</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">Huqi</span><span style="color: #800000;">"</span>, Age = <span style="color: #800080;">21</span>, Address = <span style="color: #800000;">"</span><span style="color: #800000;">Chongqing</span><span style="color: #800000;">"</span> });<br /><span style="color: #0000ff;">return</span> users;<br />}</pre>
</div>
<p align="left"><span style="font-family: 宋体;">这些基础的东西准备好了, 我们需要把这个集合序列化成json一便提供给Json2Template使用, 这里我采用Newtonsoft.Json! 这里我们需要定义个Action</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> JsonResult GetUserInfo()<br />{<br />    <span style="color: #0000ff;">return</span> Json(Newtonsoft.Json.JsonConvert.SerializeObject(InitUserInfo()), JsonRequestBehavior.AllowGet);<br />}</pre>
</div>
<p align="left"><span style="font-family: 宋体;">序列化我们的集合为json 并且启用Get请求以便ajax通过Get方式调用</span></p>
<p align="left"><span style="font-family: 宋体;">添加对json2template.js的引用后我们就开始一个ajax请求, 来获取后台的json数据, 再把获取的数据通过bindTemplate来帮定到HTML模板中显示出来</span></p>
<p align="left"><span style="font-family: 宋体;">首先我们定义个简单的HTML模板:</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="template-userinfo"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="display: none"</span><span style="color: #0000ff;">&gt;</span><br />    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">table </span><span style="color: #ff0000;">width</span><span style="color: #0000ff;">="100%"</span><span style="color: #0000ff;">&gt;</span><br />        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>编号<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>姓名<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>年龄<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>地址<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;</span><br />        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tr </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="{{item}}"</span><span style="color: #0000ff;">&gt;</span><br />            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>{{ID}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span><br />            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>{{Name}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span><br />            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>{{Age}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span><br />            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>{{Address}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span><br />        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;</span><br />    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">table</span><span style="color: #0000ff;">&gt;</span><br /><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p align="left"><span style="color: #ff0000; font-family: 宋体; background-color: #ffffff;">{ 注意:把{{item}}定义到class中表示遍历item对象的子集类似foreach }</span></p>
<p align="left"><span style="font-family: 宋体;">再定义一个用来输出这个模板的html容器</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="userlist"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p align="left"><span style="font-family: 宋体;">最后按照我们事先构想好的方式来请求json 数据并帮定模板</span></p>
<div class="cnblogs_code">
<pre>&lt;script type="text/javascript"&gt;<br />    $(document).ready(<span style="color: #0000ff;">function</span> () {<br />        <span style="color: #0000ff;">var</span> dataSouce = {};<br />        $.ajax(<br />        {<br />            url: '/home/getuserinfo',<br />            dataType: "json",<br />            success: <span style="color: #0000ff;">function</span> (data) {<br />                dataSouce.item = JSON.parse(data);<br />                $("#userlist").bindTemplate({ source: dataSouce, template: $("#template-userinfo") });<br />            }<br />        });<br />    });<br />&lt;/script&gt;</pre>
</div>
<p align="left"><span style="font-family: 宋体;">F5运行一下看看效果</span></p>
<p><img src="http://pic002.cnblogs.com/images/2011/76995/2011102914532171.jpg" alt="" /></p>
<p align="left"><span style="font-family: 宋体;">比较简单,鉴于从理论上来讲它确实还不错, 故推荐给大家!希望对你有帮助</span></p>
<p align="right"><span style="font-family: 宋体;">源代码: <a href="http://files.cnblogs.com/chenkun/Sample.Json2Template.rar">Sample.Json2Template.rar</a></span></p>
